{% extends "polls/layout.html" %}
{% load static %}

{% block body %}
<div class="row">
  
  <div class="col-7 polls">

    <div class="poll">
      <div class="question">
        <input type="hidden" id="question-id" value="0">
        <h3 class="question-text">Question</h3>
        <h5 class="question-pub-date">Publication date</h5>
        <h4 class="question-category">Category</h4>
        <br>
      </div>
      
      <div class="choices">
        <input type="hidden" id="empty" value="true">
        <input type="hidden" id="status" value="hidden">
        <div class="row">
          <div class="col-6 px-2">
            <div class="row choice mx-auto" 
              {% if user.is_authenticated %}
              onclick="voteChoice(this)"
              {% endif %}
            >
              <input type="hidden" id="choice-id" value="0">
              <input type="hidden" id="status" value="unvoted">
              <div class="col-9 px-1">
                <h4 id="choice-text">Choice 1</h4>
              </div>
              <div class="col-3 px-1 my-auto">
                <h4 id="percentage"></h4>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="display-choices" onclick="displayChoices(this)">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-bar-down" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M1 3.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5M8 6a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 0 1 .708-.708L7.5 12.293V6.5A.5.5 0 0 1 8 6"/>
        </svg>
      </div>
    </div>

  </div>
  
  <div class="col-5 create-poll">
    <h1>Create a Poll</h1>


    {% if user.is_authenticated %}
    <form class="poll-form" action="{% url 'index' %}" method="post">
      {% csrf_token %}
      <div class="question-form">
        {{ question_form }}
      </div>

      <div class="choice-form">
        <h4>Add choices</h4>
        <p>At least 2 choices are required. To add more, write them in the extra
          choice field and then click the Add button.</p>
        {{ choice_formset }}
        <div id="extra-choice-0" class="extra-choice" style="display: none;">
          <input type="text" name="choice_set-2-choice_text" class="form-control" placeholder="Extra choice (optional)" maxlength="200" id="id_choice_set-2-choice_text">
          <input type="hidden" name="choice_set-2-id" id="id_choice_set-2-id">
          <input type="hidden" name="choice_set-2-question" id="id_choice_set-2-question">
          <button id="remove-choice-btn" onclick="removeChoice(this)" class="btn btn-outline-primary" type="button">X</button>
        </div>
        <div id="add-extra-choice">
          <input type="text" class="form-control" placeholder="Extra choice (optional)" maxlength="200" id="id_choice_set-2-choice_text">
          <button id="add-extra-choice-btn" onclick="addExtraChoiceField(this)" disabled class="btn btn-outline-primary" type="button">Add</button>
        </div>
      </div>

      <div class="submit">
        <button class="btn btn-primary" type="submit">Create</button>
      </div>
    </form>
    {% else %}
      <h1 id="sign-in-prompt">
        <a href="{% url 'login_user' %}">Sign in</a> to create your own polls!
      </h1>

      <h2 id="register-prompt">Don't have an account? <a href="{% url 'login_user' %}">Register</a> here!</h2>
    {% endif %}

  </div>

</div>
{% endblock %}